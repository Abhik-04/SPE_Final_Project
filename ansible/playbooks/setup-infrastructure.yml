---
# Playbook to setup complete infrastructure (Kubernetes, ELK, Vault, MLflow)

- name: Setup Complete Infrastructure
  hosts: localhost
  gather_facts: yes
  become: no

  vars_files:
    - ../inventory/group_vars/all.yml

  tasks:
    - name: Display setup information
      debug:
        msg: "Setting up infrastructure for {{ app_name }}"

  roles:
    - role: ../roles/kubernetes-setup
      tags: ['kubernetes', 'setup']
    
    - role: ../roles/vault-config
      tags: ['vault', 'security']
      when: vault_enabled | default(false)
    
    - role: ../roles/elk-stack
      tags: ['elk', 'monitoring']
      when: elk_enabled | default(true)
